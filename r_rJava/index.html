<!DOCTYPE html> <!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]--> <!--[if (IE 7)&!(IEMobile)]><html class="no-js lt-ie9 lt-ie8"><![endif]--> <!--[if (IE 8)&!(IEMobile)]><html class="no-js lt-ie9"><![endif]--> <!--[if gt IE 8]><!--> <html class="no-js"><!--<![endif]--> <head> <meta charset="UTF-8"> <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"> <meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"> <title>R을 이용한 동시출현단어 분석 &#8211; lahuman</title> <meta name="description" content="열심히 사는 아저씨"> <meta name="keywords" content="r, rjava"> <!-- Twitter Cards --> <meta name="twitter:card" content="summary"> <meta name="twitter:image" content="https://lahuman.github.io/assets/img/logo.png"> <meta name="twitter:title" content="R을 이용한 동시출현단어 분석"> <meta name="twitter:description" content="rJava 사용하기 위한 설치 진행"> <!-- Open Graph --> <meta property="og:locale" content="ko_KR"> <meta property="og:type" content="article"> <meta property="og:title" content="R을 이용한 동시출현단어 분석"> <meta property="og:description" content="rJava 사용하기 위한 설치 진행"> <meta property="og:url" content="https://lahuman.github.io/r_rJava/"> <meta property="og:site_name" content="lahuman"> <meta property="og:image" content="https://lahuman.github.io/assets/img/logo.png"> <link rel="canonical" href="https://lahuman.github.io/r_rJava/"> <link href="https://lahuman.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="lahuman Feed"> <!-- Handheld --> <meta name="HandheldFriendly" content="True"> <meta name="MobileOptimized" content="320"> <meta name="viewport" content="width=device-width, initial-scale=1.0"> <!-- CSS --> <link rel="stylesheet" href="https://lahuman.github.io/assets/css/main.css"> <!-- JS --> <script src="https://lahuman.github.io/assets/js/modernizr-3.3.1.custom.min.js"></script> <!-- Favicons --> <link rel="apple-touch-icon" href="https://lahuman.github.io/assets/img/favicons/apple-icon-precomposed.png"> <link rel="apple-touch-icon" sizes="72x72" href="https://lahuman.github.io/assets/img/favicons/apple-icon-72x72.png"> <link rel="apple-touch-icon" sizes="114x114" href="https://lahuman.github.io/assets/img/favicons/apple-icon-114x114.png"> <link rel="apple-touch-icon" sizes="144x144" href="https://lahuman.github.io/assets/img/favicons/apple-icon-144x144.png"> <link rel="shortcut icon" type="image/png" href="https://lahuman.github.io/favicon.png" /> <link rel="shortcut icon" href="https://lahuman.github.io/favicon.ico" /> <!-- mermaid --> <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script> <script>mermaid.initialize({startOnLoad:true});</script> <!-- Background Image --> <style type="text/css">body {background-image:url(https://lahuman.github.io/assets/img/placeholder-big.jpg); background-repeat: no-repeat; background-size: cover; }</style> <!-- Post Feature Image --> </head> <body> <nav id="dl-menu" class="dl-menuwrapper" role="navigation"> <button class="dl-trigger">Open Menu</button> <ul class="dl-menu"> <li><a href="https://lahuman.github.io/">Home</a></li> <li> <a href="#">About</a> <ul class="dl-submenu"> <li> <img src="https://lahuman.github.io/assets/img/logo.png" alt="lahuman photo" class="author-photo"> <h4>lahuman</h4> <p>열심히 사는 아저씨</p> </li> <li><a href="https://lahuman.github.io/about/"><span class="btn btn-inverse">Learn More</span></a></li> <li> <a href="http://facebook.com/lahuman" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-facebook-square"></i> Facebook</a> </li> <li> <a href="http://linkedin.com/in/lahuman" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-linkedin-square"></i> LinkedIn</a> </li> <li> <a href="http://github.com/lahuman" target="_blank" rel="noopener noreferrer"><i class="fa fa-fw fa-github"></i> Github</a> </li> </ul><!-- /.dl-submenu --> </li> <li> <a href="#">Posts</a> <ul class="dl-submenu"> <li><a href="https://lahuman.github.io/posts/">All Posts</a></li> <li><a href="https://lahuman.github.io/tags/">All Tags</a></li> </ul> </li> <li><a href="https://lahuman.github.io/projects/" >Projects</a></li> </ul><!-- /.dl-menu --> </nav><!-- /.dl-menuwrapper --> <!-- Header --> <header class="header" role="banner"> <div class="wrapper animated fadeIn"> <div class="content"> <div class="post-title "> <h1>R을 이용한 동시출현단어 분석</h1> <h4>04 Apr 2019</h4> <p class="reading-time"> <i class="fa fa-clock-o"></i> Reading time ~7 minutes </p><!-- /.entry-reading-time --> <a class="btn zoombtn" href="https://lahuman.github.io/posts/"> <i class="fa fa-chevron-left"></i> </a> </div> <h1 id="r에서-rjava-사용하기-위한-설치-진행">R에서 rJava 사용하기 위한 설치 진행</h1> <p>동시출현 단어에 대한 분석이 필요하여, 검색을 해보았다. R언에에서 간단하게 함수 호출로 처리가 가능하다는 것을 확인하였다.</p> <h2 id="r-설치-하기">R 설치 하기</h2> <p><a href="https://www.digitalocean.com/community/tutorials/how-to-install-r-on-ubuntu-18-04">How To Install R on Ubuntu 18.04</a> 를 참조해서 R을 설치 했다 명령어를 따라만 해도 쉽게 설치가 된다.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># 서버 키값 추가
$&gt; sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys E298A3A825C0D65DFD57CBB651716619E084DAB9

# repository 추가
$&gt; sudo add-apt-repository 'deb https://cloud.r-project.org/bin/linux/ubuntu bionic-cran35/'

$&gt; sudo apt update

# R 설치
$&gt; sudo apt install r-base

# R Command 접근
$&gt; sudo -i R

</code></pre></div></div> <h2 id="필요-모듈-설치">필요 모듈 설치</h2> <p><a href="https://junhewk.github.io/text/2017/08/08/cooccurence-matrix-with-Naver-blog/">네이버 블로그로 동시출현단어 분석 (co-occurence network anlysis)</a>에서 힌트를 얻어서 R을 한번 진행하려고 하였는데, KoNLP 모듈의 설치에서 rJava를 설치하라는 문구를 만나며 맨붕에 빠지게 되었다.</p> <h3 id="java-설치">JAVA 설치</h3> <p>처음 실패를 계기로 구글링을 하여 다음의 해결책을 찾게 되었다. 준비해야 할 것이 몇개 있는데 큰 예로 <strong>JDK 10, 11</strong>로는 실패 하였다.</p> <p>그래서 JDK 8을 기반으로 진행하였다. JDK8 설치는 <a href="http://ubuntuhandbook.org/index.php/2018/05/install-oracle-java-jdk-8-10-ubuntu-18-04/">How to Install Oracle Java JDK 8 / 10 in Ubuntu 18.04 </a>를 참고하여 처리 하였다.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code># repostiroy 추가 
$&gt; sudo add-apt-repository ppa:webupd8team/java

# java8 설치
$&gt; sudo apt-get install oracle-java8-installer

# java8을 기본으로 사용하도록 설정
$&gt; sudo apt-get install oracle-java8-set-default
</code></pre></div></div> <h3 id="rjava-설치">rJava 설치</h3> <p>설치를 하려고 하면 많은 오류를 확인 할수 있다.</p> <p><a href="https://github.com/s-u/rJava/issues/153?fbclid=IwAR3AIi1wLW4yIx1uj7oz_yDjMC5FpO-abGYXdN0QgJMHCn7-HkAPrPEqupk">Compiling rJava macOS, java8</a>를 참고하여 설치를 하면된다.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#java config 재설정
$&gt; sudo R CMD javareconf

# R Command 진입
$&gt; sudo R
# rJava 설치 (특정 위치에서 - jdk8과 궁합이 맞는 패키지인듯)
R&gt; install.packages("https://cran.r-project.org/src/contrib/Archive/rJava/rJava_0.9-9.tar.gz")
</code></pre></div></div> <h3 id="r에서-필요한-모듈-추가">R에서 필요한 모듈 추가</h3> <p>이후 다른 패키지를 설치하기 위해서 다음 모듈을 설치해 두는 것이 좋다.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$&gt; sudo apt-get install libcurl4-openssl-dev libssl-dev libxml2-dev
</code></pre></div></div> <p>이후 필요한 패키지를 설치하면 문제 없이 설치 된다.</p> <h3 id="동시-출현-단어-분석-매트릭스">동시 출현 단어 분석 매트릭스</h3> <p><a href="https://statkclee.github.io/parallel-r/r-parallel-rscript-exec.html">.R 스크립트를 인자와 함께 실행</a>를 참고 하여 R 실행 파일을 만들고 실행을 하면 원하는 결과를 확인 가능하다.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#! /usr/bin/env Rscript

library(rvest)
library(KoNLP)
library(stringr)
library(tm)
library(qgraph)
library(dplyr)
library(networkD3)

useNIADic()

keyword &lt;- "텍스트+분석"
url &lt;- paste0("https://search.naver.com/search.naver?where=post&amp;sm=tab_pge&amp;query=", keyword, "&amp;st=sim&amp;date_option=0&amp;date_from=&amp;date_to=&amp;dup_remove=1&amp;post_blogurl=&amp;post_blogurl_without=&amp;srchby=all&amp;nso=&amp;ie=utf8&amp;start=")
searching &lt;- c()

for(page in seq(1, 100, by=10)) {
  page_url &lt;- paste0(url, page)
  result &lt;- read_html(page_url) %&gt;%
    html_nodes(css='.sh_blog_passage') %&gt;%
    html_text()
  # result &lt;- iconv(result, "UTF-8", "CP949") # 윈도우의 경우, R 작업환경에 맞춰 CP949로 변경할 필요가 있습니다.
  searching &lt;- c(searching, result)
  Sys.sleep(runif(1, 0, 1))
}

ko_words &lt;- function(doc) {
  d &lt;- as.character(doc)
  pos &lt;- unlist(SimplePos22(d))

  extracted &lt;- str_match(pos, '([가-힣]+)/[NP][A-Z]')

  keyword &lt;- extracted[, 2]
  keyword[!is.na(keyword)]
}

texts &lt;- searching %&gt;%
  str_replace_all(pattern="\r", replacement="") %&gt;%
  str_replace_all(pattern="\n", replacement=" ") %&gt;%
  str_replace_all(pattern="[[:punct:]]", replacement=" ") %&gt;%
  str_replace_all(pattern="[ㄱ-ㅎㅏ-ㅣ]+", replacement="") %&gt;%
  str_replace_all(pattern="/", replacement=" ") %&gt;%
  str_trim(side="both")

texts &lt;- texts[texts != ""]

pos &lt;- Map(ko_words, texts)


corpus &lt;- Corpus(VectorSource(pos))
stopWord &lt;- c("텍스트", "분석")
tdm &lt;- TermDocumentMatrix(corpus, control=list(
  removePunctuation=TRUE, stopwords=stopWord,
  removeNumbers=TRUE, wordLengths=c(4, 10), weighting=weightBin))
tdm.matrix &lt;- as.matrix(tdm)

word.count &lt;- rowSums(tdm.matrix)
word.order &lt;- order(word.count, decreasing=TRUE)
freq.words &lt;- tdm.matrix[word.order[1:30], ]

co.matrix &lt;- freq.words %*% t(freq.words)
print(co.matrix)
</code></pre></div></div> <p>결과는 다음과 같이 표기 된다.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>         Terms
Terms     데이터 c텍스트 분석하 통하 방법 마이닝 위하 기법 과정 가지 전처리
  데이터      26       4      5    5    6      1    3    3    3    2      3
  c텍스트      4      13      2    2    3      2    2    0    2    2      1
  분석하       5       2     11    2    3      1    2    1    0    1      0
  통하         5       2      2   11    2      1    1    2    0    0      0
  방법         6       3      3    2   10      1    0    2    1    1      1
  마이닝       1       2      1    1    1     10    1    1    1    0      0
  위하         3       2      2    1    0      1    9    1    1    0      1
  기법         3       0      1    2    2      1    1    7    0    0      1
  과정         3       2      0    0    1      1    1    0    7    0      3
  가지         2       2      1    0    1      0    0    0    0    6      0
  전처리       3       1      0    0    1      0    1    1    3    0      6
  활용         3       1      1    2    2      2    0    2    1    1      0
  대하         1       0      1    1    0      0    0    1    0    2      0
  아니         4       0      0    1    0      0    0    1    0    0      0
  요소         1       1      2    0    1      2    1    2    0    0      1
  내용         1       0      0    2    1      1    0    2    0    0      0
  수집         3       1      0    0    0      1    1    0    1    0      1
  의미         0       2      0    2    0      0    0    1    1    0      1
  철학         0       1      0    0    0      0    0    0    1    1      0
  텍스         1       2      0    0    1      0    0    0    1    1      1
  단어         0       0      0    0    0      1    0    0    0    0      1
  형태소       1       1      1    0    0      0    2    0    0    0      0
  형태         0       0      0    1    1      0    0    0    0    0      0
  단위         1       1      0    0    0      1    1    1    1    0      1
  연구         1       0      0    0    1      3    0    1    1    0      0
  결과         1       1      0    0    0      1    0    0    0    0      0
  사람         2       1      1    0    1      0    0    0    0    1      0
  주제         1       1      0    2    0      0    0    0    0    1      0
  작업         0       0      1    0    1      0    1    0    1    0      1
  c데이터      2       0      0    0    0      0    0    0    1    0      0
         Terms
Terms     활용 대하 아니 요소 내용 수집 의미 철학 텍스 단어 형태소 형태 단위
  데이터     3    1    4    1    1    3    0    0    1    0      1    0    1
  c텍스트    1    0    0    1    0    1    2    1    2    0      1    0    1
  분석하     1    1    0    2    0    0    0    0    0    0      1    0    0
  통하       2    1    1    0    2    0    2    0    0    0      0    1    0
  방법       2    0    0    1    1    0    0    0    1    0      0    1    0
  마이닝     2    0    0    2    1    1    0    0    0    1      0    0    1
  위하       0    0    0    1    0    1    0    0    0    0      2    0    1
  기법       2    1    1    2    2    0    1    0    0    0      0    0    1
  과정       1    0    0    0    0    1    1    1    1    0      0    0    1
  가지       1    2    0    0    0    0    0    1    1    0      0    0    0
  전처리     0    0    0    1    0    1    1    0    1    1      0    0    1
  활용       6    1    1    0    2    2    0    0    0    0      0    0    0
  대하       1    6    1    1    1    0    0    1    0    0      0    0    0
  아니       1    1    6    0    1    0    0    0    0    0      0    0    0
  요소       0    1    0    5    0    0    0    0    0    0      0    0    1
  내용       2    1    1    0    5    1    0    0    0    0      0    1    0
  수집       2    0    0    0    1    5    0    0    0    0      0    0    0
  의미       0    0    0    0    0    0    5    0    0    0      0    0    1
  철학       0    1    0    0    0    0    0    5    1    0      0    0    0
  텍스       0    0    0    0    0    0    0    1    4    1      0    0    0
  단어       0    0    0    0    0    0    0    0    1    4      1    0    0
  형태소     0    0    0    0    0    0    0    0    0    1      4    1    1
  형태       0    0    0    0    1    0    0    0    0    0      1    4    0
  단위       0    0    0    1    0    0    1    0    0    0      1    0    4
  연구       1    0    0    1    0    0    0    0    0    0      0    0    1
  결과       1    0    0    0    1    2    0    0    0    0      0    0    0
  사람       0    1    0    0    0    0    0    0    0    0      0    0    0
  주제       0    1    0    0    0    0    1    0    0    0      0    0    0
  작업       0    0    0    1    0    0    1    0    0    0      0    0    1
  c데이터    0    0    0    0    0    1    0    0    0    0      0    0    0
         Terms
Terms     연구 결과 사람 주제 작업 c데이터
  데이터     1    1    2    1    0       2
  c텍스트    0    1    1    1    0       0
  분석하     0    0    1    0    1       0
  통하       0    0    0    2    0       0
  방법       1    0    1    0    1       0
  마이닝     3    1    0    0    0       0
  위하       0    0    0    0    1       0
  기법       1    0    0    0    0       0
  과정       1    0    0    0    1       1
  가지       0    0    1    1    0       0
  전처리     0    0    0    0    1       0
  활용       1    1    0    0    0       0
  대하       0    0    1    1    0       0
  아니       0    0    0    0    0       0
  요소       1    0    0    0    1       0
  내용       0    1    0    0    0       0
  수집       0    2    0    0    0       1
  의미       0    0    0    1    1       0
  철학       0    0    0    0    0       0
  텍스       0    0    0    0    0       0
  단어       0    0    0    0    0       0
  형태소     0    0    0    0    0       0
  형태       0    0    0    0    0       0
  단위       1    0    0    0    1       0
  연구       4    0    0    0    0       0
  결과       0    4    0    0    0       1
  사람       0    0    4    1    0       0
  주제       0    0    1    4    0       0
  작업       0    0    0    0    4       0
  c데이터    0    1    0    0    0       4
</code></pre></div></div> <h2 id="참조-링크">참조 링크</h2> <ul> <li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-r-on-ubuntu-18-04">How To Install R on Ubuntu 18.04</a></li> <li><a href="https://junhewk.github.io/text/2017/08/08/cooccurence-matrix-with-Naver-blog/">네이버 블로그로 동시출현단어 분석 (co-occurence network anlysis)</a></li> <li><a href="https://github.com/s-u/rJava/issues/153?fbclid=IwAR3AIi1wLW4yIx1uj7oz_yDjMC5FpO-abGYXdN0QgJMHCn7-HkAPrPEqupk">Compiling rJava macOS, java8</a></li> <li><a href="http://ubuntuhandbook.org/index.php/2018/05/install-oracle-java-jdk-8-10-ubuntu-18-04/">How to Install Oracle Java JDK 8 / 10 in Ubuntu 18.04</a></li> <li><a href="https://statkclee.github.io/parallel-r/r-parallel-rscript-exec.html">.R 스크립트를 인자와 함께 실행</a></li> </ul> <div class="entry-meta"> <br> <hr> <span class="entry-tags"><a href="https://lahuman.github.io/tags/#r" title="Pages tagged r" class="tag"><span class="term">r</span></a><a href="https://lahuman.github.io/tags/#rjava" title="Pages tagged rjava" class="tag"><span class="term">rjava</span></a></span> <span class="social-share"> <a href="https://www.facebook.com/sharer/sharer.php?u=https://lahuman.github.io/r_rJava/" title="Share on Facebook" class="tag"> <span class="term"><i class="fa fa-facebook-square"></i> Share</span> </a> <a href="https://twitter.com/intent/tweet?text=https://lahuman.github.io/r_rJava/" title="Share on Twitter" class="tag"> <span class="term"><i class="fa fa-twitter-square"></i> Tweet</span> </a> <a href="https://plus.google.com/share?url=https://lahuman.github.io/r_rJava/" title="Share on Google+" class="tag"> <span class="term"><i class="fa fa-google-plus-square"></i> +1</span> </a> </span> <div style="clear:both"></div> </div> <ins class="kakao_ad_area" style="display:none;" data-ad-unit = "DAN-ubp67fs9s850" data-ad-width = "320" data-ad-height = "100"></ins> <script type="text/javascript" src="//t1.daumcdn.net/kas/static/ba.min.js" async></script> </div> </div> <section id="disqus_thread" class="animated fadeInUp"></section><!-- /#disqus_thread --> </header> <!-- JS --> <script src="https://lahuman.github.io/assets/js/jquery-1.12.0.min.js"></script> <script src="https://lahuman.github.io/assets/js/jquery.dlmenu.min.js"></script> <script src="https://lahuman.github.io/assets/js/jquery.goup.min.js"></script> <script src="https://lahuman.github.io/assets/js/jquery.magnific-popup.min.js"></script> <script src="https://lahuman.github.io/assets/js/jquery.fitvid.min.js"></script> <script src="https://lahuman.github.io/assets/js/scripts.js"></script> <!-- Global site tag (gtag.js) - Google Analytics --> <script async src="https://www.googletagmanager.com/gtag/js?id=UA-74095083-1"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-74095083-1'); </script> <script type="text/javascript"> var disqus_shortname = 'daniels-blog'; (function() { var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true; dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq); })(); (function () { var s = document.createElement('script'); s.async = true; s.type = 'text/javascript'; s.src = '//' + disqus_shortname + '.disqus.com/count.js'; (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s); }()); </script> <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> <!-- MathJax --> <script async src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script> </body> </html>
