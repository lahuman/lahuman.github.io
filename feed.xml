<?xml version="1.0" encoding="utf-8"?><?xml-stylesheet type="text/xml" href="https://lahuman.github.io/feed.xslt.xml"?><feed xmlns="http://www.w3.org/2005/Atom"><generator uri="http://jekyllrb.com" version="3.8.4">Jekyll</generator><link href="https://lahuman.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://lahuman.github.io/" rel="alternate" type="text/html" /><updated>2020-05-27T23:48:10+09:00</updated><id>https://lahuman.github.io/</id><title type="html">lahuman</title><subtitle>열심히 사는 아저씨</subtitle><entry><title type="html">swagger-node에서 express-session 설정 &amp;amp; 사용하기</title><link href="https://lahuman.github.io/swagger-node_session/" rel="alternate" type="text/html" title="swagger-node에서 express-session 설정 &amp; 사용하기" /><published>2020-05-22T00:00:00+09:00</published><updated>2020-05-22T00:00:00+09:00</updated><id>https://lahuman.github.io/swagger-node_session</id><content type="html" xml:base="https://lahuman.github.io/swagger-node_session/">&lt;h1 id=&quot;swagger-node에서-express-session-설정--사용하기&quot;&gt;swagger-node에서 express-session 설정 &amp;amp; 사용하기&lt;/h1&gt;

&lt;p&gt;기본적으로 &lt;a href=&quot;https://github.com/swagger-api/swagger-node&quot;&gt;swagger-node&lt;/a&gt;는 &lt;a href=&quot;https://expressjs.com/ko/&quot;&gt;express&lt;/a&gt;를 기반으로 동작합니다.&lt;/p&gt;

&lt;p&gt;swagger-node는 API 용으로 이용하기 때문에 기본적으로 session을 발행하지 않습니다.&lt;/p&gt;

&lt;p&gt;다만 필요에 따라 로그인 프로세스 구현을 하게 될 경우 다음 라이브러리를 이용해야 합니다.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/express-session&quot;&gt;express-session&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/body-parser&quot;&gt;body-parser&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;app.js 코드에 다음과 같이 설정을 하면 세션을 이용할수 있습니다.&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;express 4.X 부터는 body-parser를 사용하지 않고 express에서 제공되는 것을 이용합니다.
또한 &lt;strong&gt;app.use(express.urlencoded({ extended: true }));&lt;/strong&gt; 을 사용하면 fileupload 처리를 이전과 같이 사용할 수 없습니다. 아래 multer를 이용한 예제를 참고 하셔요.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;app.use(
  require(&quot;express-session&quot;)({
    secret: &quot;keyboard cat&quot;,
    cookie: {
      maxAge: 1000 * 60 * 60 , // 1 hour
    },
    resave: false,
    saveUninitialized: false,
  })
);
app.use(express.urlencoded({ extended: true }));
app.use(express.json());
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;추가로 session 관리를 &lt;a href=&quot;http://www.passportjs.org/&quot;&gt;passport&lt;/a&gt;를 이용해서 쉽게 관리 할수 있습니다.&lt;/p&gt;

&lt;p&gt;다음 예제는 SSO의 방식중 하나인 SAML으로 처리한 예제를 준비 하였습니다.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/lahuman/swagger-node_passport_saml&quot;&gt;예제 코드 바로 보기&lt;/a&gt;&lt;/p&gt;

&lt;h4 id=&quot;주요점은-passport는-express-session에서만-동작-하기-때문에-세션-설정을-잘해야-합니다&quot;&gt;주요점은 passport는 express-session에서만 동작 하기 때문에 세션 설정을 잘해야 합니다.&lt;/h4&gt;

&lt;h1 id=&quot;multer를-이용한-첨부-파일-uploade&quot;&gt;Multer를 이용한 첨부 파일 uploade&lt;/h1&gt;

&lt;blockquote&gt;
  &lt;p&gt;&lt;strong&gt;app.use(express.urlencoded({ extended: true }));&lt;/strong&gt;를 설정하면, formData를 바로 접근하지 못하게 됩니다. 이때 다음 샘플을 기준으로 첨부파일을 처리 할 수 있습니다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;// multer 설정
const multer = require(&quot;multer&quot;);
const storage = multer.diskStorage({
  // upload path
  destination: function (req, file, cb) {
    cb(null, &quot;tempfiles&quot;);
  },
  // 업로드된 파일 이름
  filename: function (req, file, cb) {
    cb(null, `${moment().format(&quot;YYYYMMDDHHmmssSSS&quot;)}${file.originalname}`);
  },
});

const upload = multer({
  storage: storage,
  limits: { fileSize: 10 * 1024 * 1024 },
});

... 설정 처리

SwaggerExpress.create(config, function (err, swaggerExpress) {
  if (err) {
    throw err;
  }
  // swagger-node에서 미들웨어 처리 방법
  app.use(
      &quot;/jira/attachments/upload&quot;,
      upload.single(&quot;filepond&quot;),
      async (req, res, next) =&amp;gt; {
        try {
          const file = req.file;
          res.status(201).json({
            status: &quot;OK&quot;,
            file_nm: file.originalname.normalize(&quot;NFC&quot;),
            file_path: file.filename,
          });
        } catch (e) {
          logger.error(e);
          res.status(400).json({ status: &quot;ERROR&quot;, message: e });
        }
      }
    );
});
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;주요 코드만 표기 하였습니다.
&lt;a href=&quot;https://github.com/lahuman/swagger-node_passport_saml&quot;&gt;예제 코드 바로 보기&lt;/a&gt;의 &lt;strong&gt;app.js&lt;/strong&gt;를 참고 하면 전체 코드를 작성하실수 있습니다.&lt;/p&gt;

&lt;h2 id=&quot;참고-자료&quot;&gt;참고 자료&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/swagger-api/swagger-node&quot;&gt;swagger-node&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://expressjs.com/ko/&quot;&gt;express&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;http://www.passportjs.org/&quot;&gt;passport&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/ques-tions/29111571/passports-req-isauthenticated-always-returning-false-even-when-i-hardcode-done&quot;&gt;passport’s req.isAuthenticated always returning false, even when I hardcode done(null, true)&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="node" /><category term="swagger" /><category term="session" /><summary type="html">추가로 passport 라이브러리와 연동하여 봅시다.</summary></entry><entry><title type="html">생각이 많아 지는 날입니다.</title><link href="https://lahuman.github.io/20200522/" rel="alternate" type="text/html" title="생각이 많아 지는 날입니다." /><published>2020-05-22T00:00:00+09:00</published><updated>2020-05-22T00:00:00+09:00</updated><id>https://lahuman.github.io/20200522</id><content type="html" xml:base="https://lahuman.github.io/20200522/">&lt;h1 id=&quot;나이가-들면-하드스킬개발-보다-소프트스킬대화에-집중-해야-한다고-하네요&quot;&gt;나이가 들면, 하드스킬(개발) 보다 소프트스킬(대화)에 집중 해야 한다고 하네요.&lt;/h1&gt;

&lt;p&gt;개발을 잘하는 건 아닌데, 꾸준히 노력하고 있습니다.&lt;/p&gt;

&lt;p&gt;나이가 들수록 주위 선배 개발자들은 개발보다는 관리 스킬에 집중하는 모습을 많이 보고 있다.&lt;/p&gt;

&lt;p&gt;이전 회사의 이직 사유는 개발하지 말고 관리를 하라는 이유였다.&lt;/p&gt;

&lt;p&gt;지금 회사도 크게 다르지 않은 느낌이다.&lt;/p&gt;

&lt;p&gt;나이가 들면 개발을 그만두어야 할까?&lt;/p&gt;

&lt;p&gt;이럴때 우리 아들은 이렇게 이야기 한다.&lt;/p&gt;

&lt;p&gt;“싫은데, 내가 왜?” 라고…&lt;/p&gt;

&lt;p&gt;자신있게 이야기 할 수 있는 내가 되도록 잘하자!&lt;/p&gt;</content><category term="단상" /><summary type="html">열심히 보단 잘하는게 중요하지요.</summary></entry><entry><title type="html">요즘 동료가 제 코드를 리뷰해주고 있습니다.</title><link href="https://lahuman.github.io/20200515/" rel="alternate" type="text/html" title="요즘 동료가 제 코드를 리뷰해주고 있습니다." /><published>2020-05-15T00:00:00+09:00</published><updated>2020-05-15T00:00:00+09:00</updated><id>https://lahuman.github.io/20200515</id><content type="html" xml:base="https://lahuman.github.io/20200515/">&lt;h1 id=&quot;단위-테스트-코드를-작성하고-있습니다&quot;&gt;단위 테스트 코드를 작성하고 있습니다.&lt;/h1&gt;

&lt;p&gt;제 코드를 기반으로 단위 테스트를 작성하면서 명확한 의미를 가지도록 변수명, 메소드 명을 리팩토링 해주고 있습니다.&lt;/p&gt;

&lt;p&gt;그러면서 저에게 현재 변수명의 의미를 묻는데 명확하게 답해주는 것도 있고 두루뭉실하게 답혀주는 것도 있습니다.&lt;/p&gt;

&lt;p&gt;명확하게 답해주는건 리펙토링 대상이 아니지만, 두루뭉실한 것들이 리펙토링 대상이 됩니다.&lt;/p&gt;

&lt;p&gt;같이 이야기 하면서 많이 생각하고 배우게 되네요.&lt;/p&gt;

&lt;h2 id=&quot;늘-내-코드는-볼때마다-부끄럽네요&quot;&gt;늘 내 코드는 볼때마다 부끄럽네요.&lt;/h2&gt;</content><category term="단상" /><summary type="html">제 코드가 부끄러우면서도 도움이 많이 되네요.</summary></entry><entry><title type="html">nodeJs] 첨부 파일를 다른 서버로 전달하기</title><link href="https://lahuman.github.io/axios_formdata_file_send/" rel="alternate" type="text/html" title="nodeJs] 첨부 파일를 다른 서버로 전달하기" /><published>2020-05-11T00:00:00+09:00</published><updated>2020-05-11T00:00:00+09:00</updated><id>https://lahuman.github.io/axios_formdata_file_send</id><content type="html" xml:base="https://lahuman.github.io/axios_formdata_file_send/">&lt;h1 id=&quot;첨부파일을-다른-서버로-포워딩-하기&quot;&gt;첨부파일을 다른 서버로 포워딩 하기&lt;/h1&gt;

&lt;p&gt;첨부 파일을 아래 그림과 같이 API server에서 받아서 다른 내부 서버에 전달을 하려고 합니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post_img/file_upload_via_server.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;API 서버에는 따로 첨부파일 정보를 저장하지 않고, buffer를 바로 내부 서버로 전달을 합니다.&lt;/p&gt;

&lt;p&gt;이를 처리하는 방식으로는 2가지가 있습니다.&lt;/p&gt;

&lt;ol&gt;
  &lt;li&gt;Proxy 사용&lt;/li&gt;
  &lt;li&gt;axios와 다른 라이브러리를 이용하여 post 통신&lt;/li&gt;
&lt;/ol&gt;

&lt;h2 id=&quot;1-proxy-사용&quot;&gt;1. Proxy 사용&lt;/h2&gt;

&lt;h4 id=&quot;필요-라이브러리&quot;&gt;필요 라이브러리&lt;/h4&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/express-http-proxy&quot;&gt;express-http-proxy&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&quot;사용법&quot;&gt;사용법&lt;/h4&gt;

&lt;p&gt;&lt;a href=&quot;https://www.npmjs.com/package/express-http-proxy&quot;&gt;express-http-proxy&lt;/a&gt;를 다음과 같이 설정하면 해당 주소로 오는 요청의 통신을 설정된 서버로 포워딩 해줍니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 예제
const proxy = require('express-http-proxy');

const app = require('express')();

app.use('/proxy', proxy('http://proxy_target_domain', {
  proxyReqPathResolver: async (req) =&amp;gt; {
    return '/proxy/target/url?id='+req.params.id;
  },
  proxyReqOptDecorator: (proxyReqOpts) =&amp;gt; {
    const newProxyReqOpts = { ...proxyReqOpts };
    newProxyReqOpts.headers = { host: 'spacial hosts', apikey: 'spacial key' };
    newProxyReqOpts.rejectUnauthorized = false;
    return newProxyReqOpts;
  },
}));
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;2-axios와-다른-라이브러리를-이용하여-post-통신&quot;&gt;2. axios와 다른 라이브러리를 이용하여 post 통신&lt;/h2&gt;

&lt;h4 id=&quot;필요-라이브러리-1&quot;&gt;필요 라이브러리&lt;/h4&gt;

&lt;ol&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/axios&quot;&gt;axios&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/multer&quot;&gt;multer&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.npmjs.com/package/form-data&quot;&gt;form-data&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&quot;사용법-1&quot;&gt;사용법&lt;/h4&gt;

&lt;p&gt;우선 첨부파일을 &lt;a href=&quot;https://www.npmjs.com/package/multer&quot;&gt;multer&lt;/a&gt;를 이용해서 객체로 만들고, 이를 &lt;a href=&quot;https://www.npmjs.com/package/form-data&quot;&gt;form-data&lt;/a&gt;로 감싸서 &lt;a href=&quot;https://www.npmjs.com/package/axios&quot;&gt;axios&lt;/a&gt;를 통해 전송합니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;const axios = require(&quot;axios&quot;);
const https = require(&quot;https&quot;);
const multer = require(&quot;multer&quot;);
const FormData = require(&quot;form-data&quot;);
const express = require('express');

const app = express();
const router = express.Router();

app.use('/', router);

const upload = multer();
router.post(
  &quot;/upload&quot;,
  upload.single(&quot;filepond&quot;), // multer를 이용하여 업로드 파일 처리
  async (req, res, next) =&amp;gt; {
    try {
      // buffer를 FormData로 감쌈
      const formData = new FormData();
      formData.append(&quot;filepond&quot;, req.file.buffer, {
        filename: req.file.originalname,
      });

      // 다른 서버로 전송
      const result = await axios.post(
        'http://proxy_target_domain/proxy/target/url',
        formData,
        {
          headers: {
            ...formData.getHeaders(),
            &quot;Content-Length&quot;: formData.getLengthSync(),
            apikey: &quot;apikey&quot;,
            host: &quot;hosts&quot;,
          },
          httpsAgent: new https.Agent({
            rejectUnauthorized: false,
          }),
        }
      );
      res.status(200).json(result.data);
    } catch (err) {
      logger.error(err);
      res
        .status(500)
        .send(`${err}`);
    }
  }
);
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;첨부 파일을 다른 서버로 전송할때 주의 할 것은&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;formData.append(&quot;filepond&quot;, req.file.buffer, {
        filename: req.file.originalname,
      });
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;이 부분에서 3번째 옵션 파라메터에 filename 이외의 값을 함부로 추가 하면 &lt;strong&gt;400 Bad request&lt;/strong&gt; 가 발생합니다.&lt;/p&gt;

&lt;h2 id=&quot;파일을-전달하는-것이-어려운게-아닌데-명확한-인터페이스를-확인하지-못해서-시간이-많이-지체-되었습니다&quot;&gt;파일을 전달하는 것이 어려운게 아닌데 명확한 인터페이스를 확인하지 못해서 시간이 많이 지체 되었습니다.&lt;/h2&gt;</content><category term="node" /><category term="axios" /><category term="proxy" /><summary type="html">Proxy를 이용하거나, axios와 몇가지 라이브러리를 사용하면 된다.</summary></entry><entry><title type="html">Ubuntu 20.04] npm install sqlite3 설치시 오류 처리</title><link href="https://lahuman.github.io/ubuntu_20.04_npm_sqlite3/" rel="alternate" type="text/html" title="Ubuntu 20.04] npm install sqlite3 설치시 오류 처리" /><published>2020-05-10T00:00:00+09:00</published><updated>2020-05-10T00:00:00+09:00</updated><id>https://lahuman.github.io/ubuntu_20.04_npm_sqlite3</id><content type="html" xml:base="https://lahuman.github.io/ubuntu_20.04_npm_sqlite3/">&lt;h1 id=&quot;ubuntu-2004-npm-install-sqlite3-설치시-오류-처리&quot;&gt;Ubuntu 20.04] npm install sqlite3 설치시 오류 처리&lt;/h1&gt;

&lt;p&gt;WSL에서 Ubuntu 20.04가 제공된다는 이야기를 듣고 바로 설치 하였습니다.&lt;/p&gt;

&lt;p&gt;node를 설치하고 진행중인 개인 프로젝트를 설치 하였는데, npm install sqlite3에서 다음과 같은 오류페이지가 표출 되었습니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post_img/sqlite3_error.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;오류를 처리하기 위해서 많은 시도를 하였지만, 모두 실패 하였습니다.&lt;/p&gt;

&lt;p&gt;결국 최후의 방법으로 Ubuntu를 삭제하고 재설치를 진행하였습니다.&lt;/p&gt;

&lt;p&gt;다음과 같이 처리하여 문제를 해결하였습니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ubuntu update
$ sudo apt-get update
$ sudo apt-get -y upgrade

# 개발도구 설치
$ sudo apt-get install -y build-essential

# node 12 설치
$ curl -sL https://deb.nodesource.com/setup_12.x | sudo -E bash -
$ sudo apt-get install -y nodejs

$ sudo npm install sqlite3
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/assets/img/post_img/sqlite3_install.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;아주 잘 설치됩니다.&lt;/p&gt;

&lt;p&gt;거의 2주간 여러 라이브러리를 설치하고 지우고를 했는데, 결국 포멧후 첨부터 다시하니 쉽게 되네요.&lt;/p&gt;

&lt;h2 id=&quot;역시-최후의-방법은-포멧입니다&quot;&gt;역시 최후의 방법은 포멧입니다.&lt;/h2&gt;</content><category term="ubuntu" /><category term="npm" /><category term="sqlite3" /><summary type="html">돌고 돌아 깔끔 처리</summary></entry><entry><title type="html">동네에 코로나바이러스 확진자가 발생하였습니다.</title><link href="https://lahuman.github.io/20200510/" rel="alternate" type="text/html" title="동네에 코로나바이러스 확진자가 발생하였습니다." /><published>2020-05-10T00:00:00+09:00</published><updated>2020-05-10T00:00:00+09:00</updated><id>https://lahuman.github.io/20200510</id><content type="html" xml:base="https://lahuman.github.io/20200510/">&lt;h1 id=&quot;끝날때까지-끝난게-아니라고-그렇게-이야기-다들-하는데&quot;&gt;끝날때까지 끝난게 아니라고 그렇게 이야기 다들 하는데…&lt;/h1&gt;

&lt;p&gt;몇몇 사람들로 인해서 다시 활성화되고 있습니다.&lt;/p&gt;

&lt;p&gt;클럽에가서 놀고 싶은 마음을 모르는건 아니지만, 시국이 시국인 만큼 참아야 한다는걸 왜 모를까요?&lt;/p&gt;

&lt;p&gt;걸려서 가족에게 옮기기라도 하면 얼마나 큰 후회를 할려고 이러는 걸까요?&lt;/p&gt;

&lt;p&gt;조금만 더 참고 조심해야 합니다.&lt;/p&gt;

&lt;h2 id=&quot;모두-조금만-더-힘내-보아요&quot;&gt;모두 조금만 더 힘내 보아요!&lt;/h2&gt;</content><category term="단상" /><summary type="html">이태원 클럽을 다녀왔다고 하네요.</summary></entry><entry><title type="html">[Dockerfile] node:Alpine에서 puppeteer 기동 &amp;amp; 한글 깨짐 처리</title><link href="https://lahuman.github.io/dockerfile_alpine_puppeteer/" rel="alternate" type="text/html" title="[Dockerfile] node:Alpine에서 puppeteer 기동 &amp; 한글 깨짐 처리" /><published>2020-04-14T00:00:00+09:00</published><updated>2020-04-14T00:00:00+09:00</updated><id>https://lahuman.github.io/dockerfile_alpine_puppeteer</id><content type="html" xml:base="https://lahuman.github.io/dockerfile_alpine_puppeteer/">&lt;h1 id=&quot;nodealpine-에서-puppeteer-기동-하고-한글-깨짐-처리-하기&quot;&gt;node:Alpine 에서 puppeteer 기동 하고 한글 깨짐 처리 하기&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://www.weave.works/blog/gitops-operations-by-pull-request&quot;&gt;GitOps&lt;/a&gt; 스타일의 지속적인 배포를 구축하여 자동 배포 시스템을 Git ==&amp;gt; jenkins ==&amp;gt; Kubernetes로 구축하여 사용하고 있습니다.&lt;/p&gt;

&lt;p&gt;배포가 문제 없이 되었으나 puppeteer를 사용하는 순간 다음과 같은 오류를 만나게 되었습니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;....
Error: Failed to launch chrome! spawn /app/node_modules/puppeteer/.local-chromium/linux-609904/chrome-linux/chrome ENOENT
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;원인 해결 방법으로 chrome을 설치하고 실행 위치를 강제로 잡아주면 된다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Dockerfile 내부
# chromium 설치
RUN apk add --no-cache udev ttf-freefont chromium

# npm 설치 시 chromium 다운하지 않도록 설정
ENV PUPPETEER_SKIP_CHROMIUM_DOWNLOAD true
# 설치된 위치를 환경 변수로 설정(node에서 사용)
ENV CHROMIUM_PATH /usr/bin/chromium-browser
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;이후 puppeteer를 실행하는 곳에서 다음과 같이 처리 해줍니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;puppeteer.launch({
  executablePath: process.env.CHROMIUM_PATH,
  args: ['--no-sandbox'], // This was important. Can't remember why
});
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;이후 다음과 같은 오류가 발생할 수 있습니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;Protocol error (IO.read): Invalid parameters handle: string value expected
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;이유는 &lt;code class=&quot;highlighter-rouge&quot;&gt;node:12-alpine&lt;/code&gt;를 사용할 경우 발생하는 오류로 &lt;code class=&quot;highlighter-rouge&quot;&gt;node:13-alpine&lt;/code&gt;를 이용하면 해결 됩니다.&lt;/p&gt;

&lt;p&gt;마지막으로 이렇게 처리 했음에도 한글이 깨지고 맙니다.&lt;/p&gt;

&lt;p&gt;한글 폰트를 다음과 같이 설치하여 줍니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# Dockerfile
# 한글 폰트 설치
RUN mkdir /usr/share/fonts/nanumfont
RUN wget http://cdn.naver.com/naver/NanumFont/fontfiles/NanumFont_TTF_ALL.zip
RUN unzip NanumFont_TTF_ALL.zip -d /usr/share/fonts/nanumfont
RUN fc-cache -f -v

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;추가--전체-dockerfile을-예제&quot;&gt;추가 : 전체 Dockerfile을 예제&lt;/h3&gt;

&lt;blockquote&gt;
  &lt;p&gt;Alpine 이란? 알파인 리눅스는 보안, 단순성 및 자원 효율성을 높이는 고급 사용자를 위해 설계된 범용 리눅스 배포판으로 musl libc와 busybox를 기반으로 하기에 GNU/Linux 배포판 보다 작고 가벼우며 yum이나 apt 같은 패키지 관리자가 아닌 apk라는 자체 패키지 관리자를 가지며 보안에 염두해두고 설계되었기에 모든 바이너리는 독립적인 실행 파일(PIE)로 컴파일 됩니다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;FROM node:13.12.0-alpine3.11 as build

USER root

# 앱 디렉터리 생성
WORKDIR /usr/src/app

COPY . .
# chromium 설치
RUN apk add --no-cache udev ttf-freefont chromium

# 한글 폰트 처리
RUN mkdir /usr/share/fonts/nanumfont
RUN wget http://cdn.naver.com/naver/NanumFont/fontfiles/NanumFont_TTF_ALL.zip
RUN unzip NanumFont_TTF_ALL.zip -d /usr/share/fonts/nanumfont
RUN fc-cache -f -v

# 앱 디렉토리로 다시 이동
RUN cd /usr/src/app
# npm install 시 Chromium 다운로드 제외 처리
ENV PUPPETEER_SKIP_CHROMIUM_DOWNLOAD true
# chromium-browser 설치 위치를 환경 변수에 저장
ENV CHROMIUM_PATH /usr/bin/chromium-browser

# 시간을 서울로 변경 처리
RUN apk --no-cache add tzdata &amp;amp;&amp;amp; \
        cp /usr/share/zoneinfo/Asia/Seoul /etc/localtime &amp;amp;&amp;amp; \
        echo &quot;Asia/Seoul&quot; &amp;gt; /etc/timezone

# Set the lang
ENV LANG=ko_KR.UTF-8 \
    LANGUAGE=ko_KR.UTF-8

# node module 설치
RUN npm  install --unsafe-perm 

# docker 외부 OPEN 포트
EXPOSE 3000
CMD [&quot;npm&quot;, &quot;start&quot;]

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;아마-나중에-다시-만날-문제일꺼-같습니다&quot;&gt;아마 나중에 다시 만날 문제일꺼 같습니다.&lt;/h2&gt;

&lt;p&gt;한글 꺠짐 문제는 늘 한번씩 돌아오네요.&lt;/p&gt;

&lt;h2 id=&quot;참고자료&quot;&gt;참고자료&lt;/h2&gt;
&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/puppeteer/puppeteer/issues/3994&quot;&gt;Error: Failed to launch chrome! spawn /app/node_modules/puppeteer/.local-chromium/linux-609904/chrome-linux/chrome ENOENT #3994&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/puppeteer/puppeteer/issues/4609&quot;&gt;v1.18.0 Page.pdf - Protocol error (IO.read): Invalid parameters handle: string value expected #4609&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="node" /><category term="alpine" /><category term="docker" /><summary type="html">Docker container에서 puppeteer 기동하고 한글 깨짐 처리</summary></entry><entry><title type="html">[Mac TIP] OS 업데이트 이후 다시 설치해야 하는 xcode 재설치 하는 법!</title><link href="https://lahuman.github.io/mac_xcode_reinstall/" rel="alternate" type="text/html" title="[Mac TIP] OS 업데이트 이후 다시 설치해야 하는 xcode 재설치 하는 법!" /><published>2020-04-09T00:00:00+09:00</published><updated>2020-04-09T00:00:00+09:00</updated><id>https://lahuman.github.io/mac_xcode_reinstall</id><content type="html" xml:base="https://lahuman.github.io/mac_xcode_reinstall/">&lt;h1 id=&quot;mac-tip-os-업데이트-이후-다시-설치해야-하는-xcode-재설치-하는-법&quot;&gt;[Mac TIP] OS 업데이트 이후 다시 설치해야 하는 xcode 재설치 하는 법!&lt;/h1&gt;

&lt;p&gt;Mac의 OS를 업데이트를 하고 나면 꼭 다음과 같은 오류를 만나게 됩니다.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;assets/img/post_img/mac_no_xcode.jpg&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;p&gt;xcode CommandLineTools을 분명히 설치 했음에도 발생합니다.&lt;/p&gt;

&lt;p&gt;이럴때는 아래의 명령어로 삭제후 재설치 하여야 합니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$&amp;gt; sudo rm -rf /Library/Developer/CommandLineTools
$&amp;gt; sudo xcode-select --install
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;mac-os-종특인듯&quot;&gt;MAC OS 종특인듯…&lt;/h2&gt;</content><category term="mac" /><category term="xcode" /><summary type="html">No Xcode or CLT version detected!</summary></entry><entry><title type="html">[TIP ReactJS] Material-UI에서 애니메이션을 제거하여 성능 향상 처리</title><link href="https://lahuman.github.io/reactjs_materialui_disable_animation/" rel="alternate" type="text/html" title="[TIP ReactJS] Material-UI에서 애니메이션을 제거하여 성능 향상 처리" /><published>2020-04-03T00:00:00+09:00</published><updated>2020-04-03T00:00:00+09:00</updated><id>https://lahuman.github.io/reactjs_materialui_disable_animation</id><content type="html" xml:base="https://lahuman.github.io/reactjs_materialui_disable_animation/">&lt;h1 id=&quot;tip-reactjs-material-ui에서-애니메이션을-제거하여-성능-향상-처리&quot;&gt;[TIP ReactJS] Material-UI에서 애니메이션을 제거하여 성능 향상 처리&lt;/h1&gt;

&lt;p&gt;얼마전 회사 내에서 ReactJS의 디자인 라이브러리에 대한 비교를 하였습니다.&lt;/p&gt;

&lt;h3 id=&quot;비교-디자인-라이브러리-목록&quot;&gt;비교 디자인 라이브러리 목록&lt;/h3&gt;

&lt;ul&gt;
  &lt;li&gt;ant design&lt;/li&gt;
  &lt;li&gt;Material-ui&lt;/li&gt;
  &lt;li&gt;React-Bootstrap&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;비교-결과&quot;&gt;비교 결과&lt;/h3&gt;

&lt;p&gt;&lt;img src=&quot;assets/img/post_img/react_design_performance.png&quot; alt=&quot;&quot; /&gt;&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;우선 React-Bootstrap의 경우 애니메이션 효과가 전혀 없기 때문에 동일한 랜더링 결과를 확인할 수 없다고 판단되었습니다.
따라서 Material-UI에서 애니메이션 효과를 제거하는 코드를 반영해보았습니다.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;h3 id=&quot;material-ui에서-애니메이션-효과를-제거하는-코드&quot;&gt;Material-UI에서 애니메이션 효과를 제거하는 코드&lt;/h3&gt;

&lt;p&gt;각 컴포넌트마다 애니메이션 효과를 제거할 수도 있고, 전체적으로 제거 할 수 있습니다.&lt;/p&gt;

&lt;p&gt;아래는 모든 컴포넌트에서 애니메이션 효과를 제거하는 코드입니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;
import { createMuiTheme, ThemeProvider } from '@material-ui/core';

const theme = createMuiTheme({
  props: {
    // Name of the component ⚛️
    MuiButtonBase: {
      // The properties to apply
      disableRipple: true, // No more ripple, on the whole application 💣!
    },
  },
  transitions: {
    // So we have 'transition: none;' everywhere
    create: () =&amp;gt; 'none',
  },
});

export default (props) =&amp;gt; {
  &amp;lt;ThemeProvider theme={theme}&amp;gt;
    &amp;lt;div className={classes.root}&amp;gt;
    ....
    &amp;lt;/div&amp;gt;
  &amp;lt;/ThemeProvider&amp;gt;
}
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;결과&quot;&gt;결과&lt;/h3&gt;

&lt;p&gt;Material-UI에서 애니메이션 효과를 제거 후 UI 성능은 눈에 띄게 좋아졌습니다.&lt;/p&gt;

&lt;p&gt;추가적으로 저성능 디바이스에서는 애니메이션 효과를 제거하고 사용하는 것을 추천합니다.&lt;/p&gt;

&lt;h2 id=&quot;참고-자료&quot;&gt;참고 자료&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/mui-org/material-ui/issues/10560&quot;&gt;Disabling animations either per-component or globally&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://material-ui.com/customization/theming/&quot;&gt;Theming&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="reactjs" /><category term="materialui" /><summary type="html">저성능 / 구형 디바이스에서 느린 경우 해결 방법</summary></entry><entry><title type="html">수동으로 설치한 WSL을 삭제 하는 방법</title><link href="https://lahuman.github.io/wsl_uninstall/" rel="alternate" type="text/html" title="수동으로 설치한 WSL을 삭제 하는 방법" /><published>2020-03-26T00:00:00+09:00</published><updated>2020-03-26T00:00:00+09:00</updated><id>https://lahuman.github.io/wsl_uninstall</id><content type="html" xml:base="https://lahuman.github.io/wsl_uninstall/">&lt;h1 id=&quot;수동으로-설치한-wsl-삭제-하기&quot;&gt;수동으로 설치한 WSL 삭제 하기&lt;/h1&gt;

&lt;p&gt;&lt;a href=&quot;https://lahuman.github.io/wsl_install_using_command/&quot;&gt;보안프로그램을 피해서 WSL 설치하기!&lt;/a&gt;를 통해서 설치한 경우 제어판 &amp;gt; 앱에 Ubuntu가 표기 되지 않습니다.&lt;/p&gt;

&lt;p&gt;압축을 풀었던 디렉토리를 삭제하고 다시 압축을 풀고 Ubuntu.exe 실행하면 그때부터는 &lt;strong&gt;0x80070003&lt;/strong&gt; 메시지를 만나게 됩니다.&lt;/p&gt;

&lt;p&gt;메뉴얼 삭제시에 windows의 wsl에 등록된 정보를 삭제하지 않았기 때문에 발생하는 문제입니다.&lt;/p&gt;

&lt;p&gt;PowerShell에서 wsl을 삭제해주어야 됩니다.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# 설치된 wsl 목록 확인
PS C:\Users\admin&amp;gt; wslconfig.exe /l
Linux 배포용 Windows 하위 시스템:
Ubuntu-18.04(기본값)

# 설치된 wsl 목록 삭제
PS C:\Users\admin&amp;gt; wslconfig.exe /u Ubuntu-18.04
삭제중...

# 이후 확인하면 설치된 wsl목록이 없음
PS C:\Users\admin&amp;gt; wslconfig.exe /l
Windows Subsystem for Linux has no installed distributions.
Distributions can be installed by visiting the Windows Store:
https://aka.ms/wslstore

# 이후 Ubuntu 디렉토리 삭제 진행
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;메뉴얼-방식으로-설치된-wsl을-삭제를-위해서는-wslconfigexe를-이용한-레지스트리-제거가-필요-합니다&quot;&gt;메뉴얼 방식으로 설치된 WSL을 삭제를 위해서는 &lt;strong&gt;wslconfig.exe&lt;/strong&gt;를 이용한 레지스트리 제거가 필요 합니다.&lt;/h2&gt;

&lt;h2 id=&quot;참고-자료&quot;&gt;참고 자료&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/microsoft/WSL/issues/3324&quot;&gt;Error 0x80070003 after manually installing/uninstalling when launching bash.exe #3324&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><category term="wsl" /><category term="uninstall" /><summary type="html">보안 프로그램을 피해서 설치한 WSL을 삭제 하는 방법</summary></entry></feed>
